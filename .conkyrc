-- --------------------------------------------
-- Copiright Dmytro Pustovit                 --
-- Components: Time, Date, DayofWeak,        --
-- CPU,PAM,Disk,Swap,Top Processes, Network  --
-- --------------------------------------------
netw = 'wlx18a6f71a84cf'
variables = {
    netw = 'wlp2s0',
    topBig = 120,
    topSml = 50,
    topInv = 5
}

local function insertVariables(s)
    return s:gsub('(#%b{})', function (w)
        return variables[w:sub(3, -2)] or w
    end)
end

local function insertAdd(s)
    return s:gsub('(%d+)+(%d+)', function(a,b)
        return a+b
    end)
end

local function insertMinus(s)
    return s:gsub('(%d+)-(%d+)', function(a,b)
        return a-b
    end)
end

local function insertMult(s)
    return s:gsub('(%d+)*(%d+)', function(a,b)
        return a*b
    end)
end

local function arifmetic(s)
    return insertMinus(insertAdd(insertMult(s)))
end

conky.config = {
    -- system
    background = false,
    alignment = "top_right",
    double_buffer = true,
    update_interval = 5,
    -- position
    gap_x = 0,
    gap_y = 0,
    maximum_width = 500,
    -- own_window properties
    own_window = true,
    own_window_type = "dock",
    own_window_hints = 'undecorated,below,sticky,skip_taskbar',
    own_window_colour = "000000",
    own_window_argb_visual = true,
    own_window_argb_value = 50,
    -- components
    draw_shades = true,
    draw_graph_borders = false,
    cpu_avg_samples = 10,
    net_avg_samples = 10,
    -- xft
    use_xft = true,
    font = "Magnolia Script:size=10",
    xftalpha = 0.1,
    -- colors
    default_color = "white",
    default_shade_color = "black",
    color0 = "00FF00",
    color1 = "FFA300"
};

text =[[
${voffset 10}${offset 10}${color EAEAEA}${font Janda Cheerful Script:pixelsize=120}${time %H:%M}
${voffset -225}${alignr 10}${font Hitch Hike:pixelsize=60}${time %d}${font Hitch Hike:pixelsize=45}${time  %B} ${time %Y}
${voffset -5}${alignr 20}${color1}${font Lemon Tuesday:pixelsize=60}${time %A}${font}

# --------------------------------------------------------------------------------
#					           CPU usage
# --------------------------------------------------------------------------------
${voffset 130}${color1}CPU usage: ${color0}${cpu cpu0}%  ${color1}Cpu: ${cpubar cpu0 15,130}  cpu1: ${cpubar cpu1 15,40} cpu2: ${cpubar cpu2 15,40}
${hr 1}$color
${offset 170}${voffset -5}${cpugraph cpu0 80,310 -t -l}
${color0}${voffset -85}Температура: $color ${acpitemp}°C${goto 116}${voffset 8}${offset 100}${cpu cpu0}% ${color0}${goto 116}${offset 100}${voffset 13}CPU1$color${goto 191}${offset 100}${voffset -12}${cpu cpu1}% ${color0}${goto 191}${offset 100}${voffset 12}CPU2$color
${color0}${voffset -16}Процесів:$color $processes
${color0}${voffset 6}Запущено: $color  $running_processes
${color0}${voffset 6}Частота:$color ${freq}MHz
${color0}${voffset 6}Середнє навантаження:$color ${loadavg}
# -------------------------------------------------------------------------------
# 					DISK/RAM/SWAP usage
# -------------------------------------------------------------------------------
${color1}${voffset 2}${hr 1}
${offset 170}${voffset -5}${memgraph 60,310}
${color0}${voffset -70}RAM $color${memperc}%
${color0}DISK $color${fs_used_perc /}%
${color0}Swap $color${swapperc}%
# --------------------------------------------------------------------------------
# 					   Running processes
# --------------------------------------------------------------------------------
${color1}${voffset 5}${hr 1}
${color0}${voffset 2}NAME${goto #{topBig}}CPU%${goto #{topBig}+#{topSml}}PID${goto #{topBig}+2*#{topSml}}NAME${goto 2*#{topBig}+2*#{topSml}}RAM${goto 2*#{topBig}+3*#{topSml}+3*#{topInv}}PID${voffset 5}
$color${top name 1}${goto #{topBig}}${top cpu 1}${goto #{topBig}+#{topSml}}${top pid 1}${color1}${goto #{topBig}+2*#{topSml}}${top_mem name 1}${goto 2*#{topBig}+2*#{topSml}}${top_mem mem_res 1}${goto 2*#{topBig}+3*#{topSml}+3*#{topInv}}${top_mem pid 1}
$color${top name 2}${goto #{topBig}}${top cpu 2}${goto #{topBig}+#{topSml}}${top pid 2}${color1}${goto #{topBig}+2*#{topSml}}${top_mem name 2}${goto 2*#{topBig}+2*#{topSml}}${top_mem mem_res 2}${goto 2*#{topBig}+3*#{topSml}+3*#{topInv}}${top_mem pid 2}
$color${top name 3}${goto #{topBig}}${top cpu 3}${goto #{topBig}+#{topSml}}${top pid 3}${color1}${goto #{topBig}+2*#{topSml}}${top_mem name 3}${goto 2*#{topBig}+2*#{topSml}}${top_mem mem_res 3}${goto 2*#{topBig}+3*#{topSml}+3*#{topInv}}${top_mem pid 3}
$color${top name 4}${goto #{topBig}}${top cpu 4}${goto #{topBig}+#{topSml}}${top pid 4}${color1}${goto #{topBig}+2*#{topSml}}${top_mem name 4}${goto 2*#{topBig}+2*#{topSml}}${top_mem mem_res 4}${goto 2*#{topBig}+3*#{topSml}+3*#{topInv}}${top_mem pid 4}
# -------------------------------------------------------------------------------
# 						Network
# -------------------------------------------------------------------------------
${color1}${voffset 5}${hr 1}$color
${offset 250}${downspeedgraph #{netw} 40,200 324D23 77B753 -l}
${voffset -40}${color0}IP Адреса: $color${addrs #{netw}}
${color0}Зовнішня IP: $color${execpi 3600 wget -q -O /dev/stdout http://checkip.dyndns.org/ | cut -d : -f 2- | cut -d \< -f -1}
${color0}MAC адреса: $color ${wireless_ap #{netw}}
${color0}Якість зв''язку: $color${wireless_link_qual_perc #{netw}}%
${color0}Бітрейт: $color${wireless_bitrate #{netw}}
${offset 250}${upspeedgraph #{netw} 40,200 4B1B0C FF5C2B -l}
${voffset -50}${color0}Завантаження: $color${downspeed #{netw}}
${color0}Відвантаження: $color${upspeed #{netw}}
${color0}Загалом Завантажено:$color${totaldown #{netw}}
${color0}Загалом Відвантажено:$color${totalup #{netw}}
]]

conky.text = arifmetic(arifmetic(insertVariables(text)))